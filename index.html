<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>

  <!-- Biblioteca Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <!-- Cliente Supabase -->
  <script src="./supabase.js"></script>
</head>
<body>

  <h2>Login</h2>

  <input id="email" type="email" placeholder="Email" />
  <br><br>
  <input id="password" type="password" placeholder="Senha (mín. 6 caracteres)" />
  <br><br>

  <button id="btnSignup">Cadastrar</button>
  <button id="btnLogin">Entrar</button>

  <script>
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const btnSignup = document.getElementById("btnSignup");
    const btnLogin = document.getElementById("btnLogin");

    // CADASTRO
    btnSignup.addEventListener("click", async () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();

      if (!email || !password) {
        alert("Preencha email e senha");
        return;
      }

      const { error } = await window.supabaseClient.auth.signUp({
        email: email,
        password: password
      });

      if (error) {
        alert("Erro: " + error.message);
      } else {
        alert("Usuário criado! Agora clique em Entrar.");
      }
    });

    // LOGIN
    btnLogin.addEventListener("click", async () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();

      const { error } = await window.supabaseClient.auth.signInWithPassword({
        email: email,
        password: password
      });

      if (error) {
        alert("Erro: " + error.message);
        return;
      }

      // login OK → vai para o app
      window.location.href = "./treinos.html";
    });
  </script>

</body>
</html>
